<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>TIDS - Home</title>
<style>
body{font-family:'Roboto',sans-serif;background:linear-gradient(135deg,#2575fc,#6a11cb);color:#fff;margin:0;padding:0;}
header{text-align:center;padding:40px 20px;}
header h1{font-size:40px;margin-bottom:10px;}
header p{font-size:18px;}
.avatar-circle{width:120px;height:120px;border-radius:50%;display:flex;justify-content:center;align-items:center;font-size:60px;font-weight:bold;margin:0 auto 10px auto;background:#2575fc;}
button{padding:10px 20px;border:none;border-radius:10px;background:#ffd700;color:#333;cursor:pointer;font-weight:bold;margin-top:10px;transition:0.3s;}
button:hover{background:#ffea00;transform:scale(1.05);}
section{padding:30px 20px;max-width:900px;margin:20px auto;background:rgba(255,255,255,0.1);border-radius:20px;backdrop-filter:blur(5px);}
h2{color:#ffd700;margin-bottom:15px;}
ul{list-style:none;}
ul li{padding:10px 0;font-size:18px;}
.custom-file-upload{display:inline-block;padding:10px 20px;cursor:pointer;border-radius:10px;background:#ffd700;color:#333;font-weight:bold;transition:0.3s;margin-top:10px;}
.custom-file-upload:hover{background:#ffea00;transform:scale(1.05);}
.custom-file-upload input{display:none;}
.tab{display:none;}
.tab.active{display:block;}
nav{display:flex;justify-content:center;margin-bottom:20px;}
nav button{margin:0 10px;}
.participant{display:flex;justify-content:space-between;align-items:center;margin:5px 0;background:rgba(255,255,255,0.1);padding:5px 10px;border-radius:10px;}
.participant button{padding:5px 10px;margin-left:5px;font-size:12px;}
</style>
</head>
<body>
<header>
{% if avatar %}
<img src="/img/{{ avatar }}" alt="Avatar" style="width:120px;height:120px;border-radius:50%; display:block; margin:0 auto 10px auto;">
{% else %}
<div class="avatar-circle">{{ username[0]|upper }}</div>
{% endif %}
<h1>Bem-vindo, {{ username }}!</h1>
<p>Tecnologia, Inovação, Desenvolvimento e Software</p>
<a href="/logout"><button>Sair</button></a>
</header>

<nav>
<button onclick="showTab('sobre')">Sobre</button>
<button onclick="showTab('servicos')">Serviços</button>
<button onclick="showTab('funcionarios')">Funcionários</button>
<button onclick="showTab('reuniao')">Reunião</button>
<button onclick="showTab('notificacoes')">Notificações</button>
{% if special %}<button onclick="location.href='/controle'">Controle</button>{% endif %}
</nav>

<section id="sobre" class="tab active">
<h2>Sobre a Empresa</h2>
<p>Esta é uma empresa de programação criada para desenvolver soluções em software e tecnologia.</p>
</section>

<section id="servicos" class="tab">
<h2>Serviços</h2>
<ul>
<li>Desenvolvimento de sites</li>
<li>Aplicações web</li>
<li>Automação e scripts</li>
</ul>
</section>

<section id="funcionarios" class="tab">
<h2>Funcionários</h2>
<ul>
{% for user in users %}
<li>{{ user.username }} - Pontos: {{ user.points }}</li>
{% endfor %}
</ul>
</section>

<section id="reuniao" class="tab">
<h2>Reunião</h2>
<div id="meeting-status"></div>
</section>

<section id="notificacoes" class="tab">
<h2>Notificações</h2>
<div id="notificacoes-list"></div>
</section>

<script>
function showTab(id){
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}

async function updateMeeting(){
    const res = await fetch('/meeting_status');
    const data = await res.json();
    let html = '';
    if(data.active){
        html += '<p>Admin: '+data.admin+'</p>';
        html += '<h4>Participantes:</h4>';
        for(const user in data.participants){
            html += '<div class="participant">'+user+'<span></span></div>';
        }
    }else{
        html += '<p>Nenhuma reunião ativa.</p>';
    }
    document.getElementById('meeting-status').innerHTML = html;
}

setInterval(updateMeeting,50);
updateMeeting();
</script>
</body>
</html>
